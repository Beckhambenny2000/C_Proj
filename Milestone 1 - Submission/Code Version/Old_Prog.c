#include <stdio.h>#include <stdbool.h>#include <ctype.h>#include <string.h>#include "SatComRelay.h"											        	//Include header file to this prog#define ROWS 31#define COLS 39                                                        void init(char *filename,bool *scr_name_bl,bool *random_start_pos_bl,int *mission) //init program run and return 4 variable to init{    char scr_name, random_start_pos;                                            // Create 2 character variable	printf("\nPlease enter the scenario file's name        : ");	scanf("%s",filename);                                                       // User to enter file name in string	while (getchar() != '\n');													// Clear buffer    printf("\n");                                                               // Print new line    while(scr_name != 'y' && scr_name != 'n')                                   // Check if the input is either 'y' or 'n' if not loop    {    	printf("Is the scenario name encrypted          (y/n): ");    	scanf("%c",&scr_name);                                                  // User to enter scenario name in character     	while(getchar() != '\n');												// Clear buffer	    	    	if (scr_name == 'y')                                                    // Check if variable is y    	{      		*scr_name_bl = 1;                                                   // If variable is y, new variable boolean is 1    	}    	else if (scr_name == 'n')                                               // Check if variable is n    	{			*scr_name_bl = 0;                                                   // If variable is n, new variable boonlean is 0     	}   		else                                                                    // If none of the variable is met, the program will exit    	{        	printf("error in input \n");                                        // print out error and loop back to the top to re-enter char value    	}    	printf("\n");    }    while (random_start_pos != 'y' && random_start_pos != 'n')    {    	printf("Do you wish to randomize start position (y/n): ");    	scanf(" %c",&random_start_pos);                                         // User to enter random in character    	if (random_start_pos == 'y')    	{        	*random_start_pos_bl = 1;    	}    	else if (random_start_pos == 'n')    	{        	*random_start_pos_bl = 0;    	}    	else    	{        	printf("error in input \n");    	}    	printf("\n");	}    printf("Please select mission type below\n\n");    printf(" 1) Casual Explore\n");    printf(" 2) Find  1   End Point\n");    printf(" 3) Reach 1   End Point \n");    printf(" 4) Find  ALL End Point \n");    printf(" 5) Reach ALL End Point \n");    printf(" 6) Reach ALL Danger Point \n");    printf(" 7) Find Map Boundaries \n");    printf(" 8) Explore Everything \n\n");    while(*mission <= 0 || *mission > 8 )                                       // Check if mission number is less than 0 or more than 8, if not loop    {    	printf("Enter your choice (1-8) : ");                                       	scanf("%d",mission);                                                    // User to enter mission number in int                   }    printf("\n");    printf("filename : %s, is FileEncrypted : %d, randomizeStartposition : %d \n",filename,*scr_name_bl,*random_start_pos_bl); // print string file name and both boolean }void Pre_Game_info()                                                            //Pre_Game program info run{    char ykey = ' ';    printf("\n\n");    printf("************************************************ \n");    printf("*** Welcome to Mr Tian's Vehicle Simulator ! *** \n");    printf("************************************************ \n\n\n");    printf("[ Usage Instructions ] \n\n");    printf("------------------------------------------------------------------------------------ \n\n");    printf("Enter 'q' to Quit\n\n");    printf("Enter 'v' to show this Usage Instruction (again ..) \n\n");    printf("'w', 's', 'a', 'd' keys to MOVE vehicle North South, West & East \n\n");    printf("Enable 'Numlock', (right key pad), keys 1-9 (except 5) to SCAN terrain : \n");    printf("SW (1), S(2), SE (3), W (4), E (6), NW (7), N(8), NE (9) respectively \n\n");    printf("'t' Key = Toggle Scan Radius (betw. 1-2) \n\n");    printf("'i' Key = increase / divert energy to shield \n\n");    printf("'z' Key = Info on Vehicle Status \n");    printf("'x' Key = Map of terrain scanned by vehicle \n");    printf("'c' Key = Map of terrain travelled by vehicle \n\n");    printf("Note : In map display, ' ' underline indicates curr. veh. location!\n\n");    printf("------------------------------------------------------------------------------------ \n\n");     while(ykey != 'y')                                                          // Check 'y' key enter if not loop    {    	printf("press'y' key and hit Enter to continue: ");    	scanf(" %c",&ykey);                                                     // User to enter 'y' key    	printf("\n");	}}void my_vehicle_status(long initialEnergy,long totEnergyUsed,long totShieldEnergyUsed,long currEnergy,long currShieldEnergy) // print status of vehicle{	printf("Initial Enrg : %1ld, Tot Enrg Use : %1ld, Tot Shld Enrg Use : % 1ld, Engy Left : %1ld, Shld Enrg Left : %1ld \n\n", initialEnergy,totEnergyUsed,totShieldEnergyUsed,currEnergy,currShieldEnergy);}void printscanMatrix(char S_matrix[ROWS][COLS], int midRow, int midCol ) {    for (int i = 0; i < ROWS; i++)    {        for (int j = 0; j < COLS; j++)         {            if (i == midRow && j == midCol)             {                printf("\033[4m"); // Start underlining            }            char currentChar = S_matrix[i][j];            switch (currentChar)             {                case '#':                 case 'X':                    printf("\033[31m%c\033[0m", currentChar);  // Red                    break;                case 'M':                    printf("\033[35m%c\033[0m", currentChar);  // purple                    break;                case 'h':                case 'f':                    printf("\033[32m%c\033[0m", currentChar);  // dark green                    break;                case 'w':                    printf("\033[33m%c\033[0m", currentChar);  // yellow                    break;                case '~':                    printf("\033[36m%c\33[0m", currentChar);  // cyan                    break;                default:                    printf("%c", currentChar);  // Default formatting for other characters                    break;            }            if (i == midRow && j == midCol)             {                printf("\033[0m "); // Stop underlining and reset formatting            }            else             {                printf(" "); // Ensure spacing is consistent            }        }        printf("\n");    }}void printtravelMatrix(char T_matrix[ROWS][COLS], int midRow, int midCol ) {    for (int i = 0; i < ROWS; i++)    {        for (int j = 0; j < COLS; j++)         {            if (i == midRow && j == midCol)             {                printf("\033[4m"); // Start underlining            }                        char currentChar = T_matrix[i][j];            switch (currentChar)             {                case '#':                 case 'X':                    printf("\033[31m%c\033[0m", currentChar);  // Red                    break;                case 'M':                    printf("\033[35m%c\033[0m", currentChar);  // purple                    break;                case 'h':                case 'f':                    printf("\033[32m%c\033[0m", currentChar);  // dark green                    break;                case 'w':                    printf("\033[33m%c\033[0m", currentChar);  // yellow                    break;                case '~':                    printf("\033[36m%c\33[0m", currentChar);  // cyan                    break;                case 'E':                    printf("\033[37m%c\33[0m", currentChar);  // white                    break;                case '_':                	printf("\033[47;37m%c\33[0m", currentChar); // White background with white word                	break;                default:                    printf("%c", currentChar);  // Default formatting for other characters                    break;            }            if (i == midRow && j == midCol)             {                printf("\033[0m "); // Stop underlining and reset formatting            }            else             {                printf(" "); // Ensure spacing is consistent            }        }        printf("\n");    }}typedef struct {    char character;    int count;    int energy;} CharCounter;typedef struct {    char character;    int count;    int energy;      int shield;	 // travelled counter} CharCounter2;void incrementCountAndUpdateEnergy(CharCounter counters[], int size, char input, int energyUsed) {    for (int i = 0; i < size; i++)     {        if (counters[i].character == input) {            counters[i].count++;            counters[i].energy = energyUsed;            //return;        }    }    printf("Character '%c' is not being tracked.\n", input);}void T_counter(CharCounter2 counters[], int size, char input, int energyUsed, int shieldUsed) {    for (int i = 0; i < size; i++) {        if (counters[i].character == input) {            counters[i].count++;            counters[i].energy = energyUsed;            counters[i].shield = shieldUsed;            //return;        }    }    printf("Character '%c' is not being tracked.\n", input);}void printCountsAndEnergy(const CharCounter counters[], int size, const char *setName) {    printf("%s \n", setName);    for (int i = 0; i < size; i++) {        printf("Type '%c' : %d times, %d energy.\n",               counters[i].character, counters[i].count, counters[i].energy);    }}void printT_counter(const CharCounter2 counters[], int size, const char *setName) {    printf("%s:\n", setName);    for (int i = 0; i < size; i++) {        printf("Type '%c' : %d time, %d energy, %d shield \n",               counters[i].character, counters[i].count, counters[i].energy, counters[i].shield);    }}int main(){    char filename[15], command, scanresult;                                     // Create 3 variable, 1 string and 2 charcter    bool scr_name_bl, random_start_pos_bl;                                      // Create 2 boolean variable    int mission = 0, radius = 1, movement = 0, scanned = 0;                     // Create 3 integer variable    long energyToAllocate,before_energy,before_shield;                          // Create 3 long variable    char S_matrix[ROWS][COLS];    char T_matrix[ROWS][COLS];    int midRow = ROWS / 2; // Calculate the middle row index    int midCol = COLS / 2; // Calculate the middle column index    for (int i = 0; i < ROWS; i++)												// Set size for scan matrix     {        for (int j = 0; j < COLS; j++)         {            S_matrix[i][j] = ' ';        }    }    for (int i = 0; i < ROWS; i++) 												// Set size for travel    {        for (int j = 0; j < COLS; j++)         {            T_matrix[i][j] = ' ';        }    }    CharCounter S_1_terrain[] = {{'#', 0, 0}, {' ', 0, 0}, {'j', 0, 0}, {'M', 0, 0}, {'~', 0, 0}, {'X', 0, 0}, {'S', 0, 0}, {'E', 0, 0}, {'?', 0, 0}, {'f', 0, 0}, {'h', 0, 0}, {'w', 0, 0}};    CharCounter S_2_terrain[] = {{'#', 0, 0}, {' ', 0, 0}, {'j', 0, 0}, {'M', 0, 0}, {'~', 0, 0}, {'X', 0, 0}, {'S', 0, 0}, {'E', 0, 0}, {'?', 0, 0}, {'f', 0, 0}, {'h', 0, 0}, {'w', 0, 0}};    CharCounter2 T_terrain[] = {{'#', 0, 0, 0}, {' ', 0, 0, 0}, {'j', 0, 0, 0}, {'M', 0, 0, 0}, {'~', 0, 0, 0}, {'X', 0, 0, 0}, {'S', 0, 0, 0}, {'E', 0, 0, 0}, {'f', 0, 0, 0}, {'h', 0, 0, 0}, {'w', 0, 0, 0}};    //Pre-Game    init(filename,&scr_name_bl,&random_start_pos_bl,&mission);                  // Create a void loop to run section    VehDataType vehicle = SCRelay_Signal_Veh_Init(filename,&scr_name_bl,&random_start_pos_bl,mission); // Sent out data to header file and gets and output    Pre_Game_info();                                                            // Create a void loop to run section	//Game    while(command != 'q')                                                       // Program will run forever until 'q' received    {        printf("Enter your command (q to quit) : ");        scanf(" %c",&command);                                                  // User to enter command        while (getchar() != '\n');											    // Clear buffer        printf("\n");        if(isdigit(command) && command != '5' && command != '0')                // Check value is digit except 5 and 0    	{    		scanned++;                                                          // increase counter by 1 if above condition is met    		before_energy = vehicle.totEnergyUsed;                              // store before energy before scanning    		if (radius == 1)                                                    // Check radius is 1    		{            	if (command == '1')												// Scan South West 1            	{              		scanresult = SCRelay_Signal_Veh_ScanSouthWest (&vehicle);   // Get result from header file and store into scan result              		printf("SW 1 \n");              		S_matrix[midRow+1][midCol-1] = scanresult;                  // put scan result into matrix map in respective position            	}            	else if (command == '2')            	{              		scanresult = SCRelay_Signal_Veh_ScanSouth (&vehicle);       // Scan South 1              		printf("S 1 \n");              		S_matrix[midRow+1][midCol] = scanresult;            	}            	else if (command == '3')            	{              		scanresult = SCRelay_Signal_Veh_ScanSouthEast (&vehicle);   // Scan South East 1              		printf("SE 1 \n");              		S_matrix[midRow+1][midCol+1] = scanresult;            	}            	else if (command == '4')            	{              		scanresult = SCRelay_Signal_Veh_ScanWest (&vehicle);        // Scan West 1              		printf("W 1 \n");              		S_matrix[midRow][midCol-1] = scanresult;            	}            	else if (command == '6')            	{              		scanresult = SCRelay_Signal_Veh_ScanEast (&vehicle);        // Scan East 1              		printf("E 1 \n");              		S_matrix[midRow][midCol+1] = scanresult;            	}            	else if (command == '7')            	{              		scanresult = SCRelay_Signal_Veh_ScanNorthWest (&vehicle);   // San North West              		printf("NW 1 \n");              		S_matrix[midRow-1][midCol-1] = scanresult;            	}            	else if (command == '8')            	{              		scanresult = SCRelay_Signal_Veh_ScanNorth (&vehicle);       // Scan North              		printf("N 1 \n");              		S_matrix[midRow-1][midCol] = scanresult;            	}            	else if (command == '9')            	{              		scanresult = SCRelay_Signal_Veh_ScanNorthEast (&vehicle);   // Scan North East              		printf("NE 1 \n");              		S_matrix[midRow-1][midCol+1] = scanresult;            	}            	incrementCountAndUpdateEnergy(S_1_terrain, sizeof(S_1_terrain) / sizeof(S_1_terrain[0]), scanresult, vehicle.totEnergyUsed - before_energy );            	// ^^ store scan result character and count number of times it appear and how much energy used to scan current terrain to 1 unit radius    		}    		else if (radius == 2)                                               // Check if radius is 2    		{        		if (command == '1')												        		{               		scanresult = SCRelay_Signal_Veh_ScanSouthWest2 (&vehicle);  // Scan South West 2               		printf("SW 2 \n");               		S_matrix[midRow+2][midCol-2] = scanresult;            	}        		else if (command == '2')										            	{               		scanresult = SCRelay_Signal_Veh_ScanSouth2 (&vehicle);      // Scan South 2               		printf("S 2 \n");               		S_matrix[midRow+2][midCol] = scanresult;            	}        		else if (command == '3')											            	{               		scanresult = SCRelay_Signal_Veh_ScanSouthEast2 (&vehicle);  // Scan South East 2               		printf("SE 2 \n");               		S_matrix[midRow+2][midCol+2] = scanresult;            	}        		else if (command == '4')											            	{               		scanresult = SCRelay_Signal_Veh_ScanWest2 (&vehicle);       // Scan West 2               		printf("W 2 \n");               		S_matrix[midRow][midCol-2] = scanresult;            	}        		else if (command == '6')										            	{               		scanresult = SCRelay_Signal_Veh_ScanEast2 (&vehicle);       // Scan East 2               		printf("E 2 \n");               		S_matrix[midRow][midCol+2] = scanresult;            	}        		else if (command == '7')											            	{               		scanresult = SCRelay_Signal_Veh_ScanNorthWest2 (&vehicle);  // Scan North West 2               		printf("NW 2 \n");               		S_matrix[midRow-2][midCol-2] = scanresult;            	}        		else if (command == '8')										            	{               		scanresult = SCRelay_Signal_Veh_ScanNorth2 (&vehicle);      // Scan North               		printf("N 2 \n");               		S_matrix[midRow-2][midCol] = scanresult;            	}        		else if (command == '9')										            	{               		scanresult = SCRelay_Signal_Veh_ScanNorthEast2 (&vehicle);  // Scan North East               		printf("NE 2 \n");               		S_matrix[midRow-2][midCol+2] = scanresult;            	}            	incrementCountAndUpdateEnergy(S_2_terrain, sizeof(S_2_terrain) / sizeof(S_2_terrain[0]), scanresult, vehicle.totEnergyUsed - before_energy);            	// ^^ store scan result character and count number of times it appear and how much energy used to scan current terrain to 2 unit radius        	}        	printf("Returned (scanned) terrain symbol is '%c' \n",scanresult);  // Print out symbol scanned        	my_vehicle_status(vehicle.initialEnergy,vehicle.totEnergyUsed,vehicle.totShieldEnergyUsed,vehicle.currEnergy,vehicle.currShieldEnergy); //Print status of vehicle        	printf("\n");        	printscanMatrix(S_matrix, midRow, midCol);        	printf("\n\n");     	}    	else if (command == 'w'|| command == 'a'|| command == 's'||command == 'd')    	{    		movement++;    		before_energy = vehicle.totEnergyUsed;    		before_shield = vehicle.totShieldEnergyUsed;        	if (command == 'w')        	{        		if (S_matrix[midRow-1][midCol] != ' ')        		{        			printf(" S_data \n");        			scanresult = S_matrix[midRow-1][midCol];        		}        		else if (T_matrix[midRow-1][midCol] != ' ')        		{        			printf("T_Data \n");        			scanresult = T_matrix[midRow-1][midCol];        		}        		else        		{        			printf(" Empty_data \n");        			scanresult = SCRelay_Signal_Veh_ScanNorth(&vehicle);        		}        		        		vehicle = SCRelay_Signal_Veh_MoveUpNorth();                      // Header file sends output when 'w' is entered        		if (scanresult != '#' && scanresult != '?')        		{        			midRow -= 1;        			T_matrix[midRow][midCol] = scanresult;        			printf("MOVEEE");        		}        	}        	else if (command == 'a')        	{        		if (S_matrix[midRow][midCol-1] != ' ')        		{        			printf(" S_data \n");        			scanresult = S_matrix[midRow][midCol-1];        		}        		else if (T_matrix[midRow][midCol-1] != ' ')        		{        			printf("T_Data \n");        			scanresult = T_matrix[midRow][midCol-1];        		}        		else        		{        			printf(" Empty_data \n");        			scanresult = SCRelay_Signal_Veh_ScanWest (&vehicle);        		}        		vehicle = SCRelay_Signal_Veh_MoveLeftWest();                      // Header file sends output when 'a' is entered        		if (scanresult != '#' && scanresult != '?')        		{        			midCol -= 1;        			T_matrix[midRow][midCol] = scanresult;        			printf("MOVEEE");        		}	        	}        	else if (command == 's')        	{        		if (S_matrix[midRow+1][midCol] != ' ')        		{        			printf(" S_data \n");        			scanresult = S_matrix[midRow+1][midCol];        		}        		else if (T_matrix[midRow+1][midCol] != ' ')        		{        			printf("T_Data \n");        			scanresult = T_matrix[midRow+1][midCol];        		}        		else        		{        			printf(" Empty_data \n");        			scanresult = SCRelay_Signal_Veh_ScanSouth (&vehicle);        		}        		vehicle = SCRelay_Signal_Veh_MoveDownSouth();                      // Header file sends output when 's' is entered        		if (scanresult != '#' && scanresult != '?')        		{        			midRow += 1;        			T_matrix[midRow][midCol] = scanresult;        			printf("MOVEEE");	        		}	        	}        	else if (command == 'd')        	{	        		if (S_matrix[midRow][midCol+1] != ' ')        		{        			printf(" S_data \n");        			scanresult = S_matrix[midRow][midCol+1];        		}        		else if (T_matrix[midRow][midCol+1] != ' ')        		{        			printf("T_Data \n");        			scanresult = T_matrix[midRow][midCol+1];        		}        		else        		{        			printf(" Empty_data \n");        			scanresult = SCRelay_Signal_Veh_ScanEast (&vehicle);        		}        		vehicle = SCRelay_Signal_Veh_MoveRightEast();                      // Header file sends output when 'd' is entered        		if (scanresult != '#' && scanresult != '?')        		{        			midCol += 1;        			T_matrix[midRow][midCol] = scanresult;        			printf("MOVEEE");        		}        	}        	if (scanresult == ' ')        	{        		T_matrix[midRow][midCol] = '_';        	}        	        	printf("\n");        	T_counter(T_terrain, sizeof(T_terrain) / sizeof(T_terrain[0]), scanresult, vehicle.totEnergyUsed - before_energy, vehicle.totShieldEnergyUsed - before_shield);        	my_vehicle_status(vehicle.initialEnergy,vehicle.totEnergyUsed,vehicle.totShieldEnergyUsed,vehicle.currEnergy,vehicle.currShieldEnergy); //Print status of vehicle        	printtravelMatrix(T_matrix, midRow, midCol);        	scanresult = '_';        	printf("\n");     	}	    	else if (command == 't')    	{        	if(radius == 1)        	{            	radius = 2;        	}        	else if (radius == 2)        	{            	radius = 1;        	}        	printf("Toggle Scan Radius => now set to %d terrain units! \n\n\n",radius);    	}    	else if (command == 'i')        {        	printf("Enter amt. of energy to increase / allocate to shields (1 - 100000) : ");        	scanf(" %ld",&energyToAllocate);                                    // Enter amount of energy to allocate        	vehicle = SCRelay_Signal_Veh_AllocateToShield(energyToAllocate);    // Send out energy to allocate to header file and gets output        	printf("\n\n");        }        else if (command == 'v')                                                     // Check if command is 'v'        {            Pre_Game_info();                                                    // Print Pre_Game_info if command is 'v'        }        else if (command == 'z')        {        	printf("Vehicle Status / Statistics : \n\n");        	my_vehicle_status(vehicle.initialEnergy,vehicle.totEnergyUsed,vehicle.totShieldEnergyUsed,vehicle.currEnergy,vehicle.currShieldEnergy); //Print status of vehicle         	printf("\n");        }    	else if (command == 'x')    	{    		printf("Currently Scanned Terrain Layout : \n");        	printtravelMatrix(S_matrix, midRow, midCol);    	}    	else if (command == 'c')    	{    		printf("Currently ExploredTerrain Layout : \n");    		printscanMatrix(T_matrix, midRow, midCol);    	}    	else if (command == 'q');    	else    	{        	printf("Invalid Command : '%c', please try again!\n\n",command);    	}	}		// Post Game	printf("--------------------------------- \n");    printf("--- Team 1 ExplorationReport! --- \n");    printf("--------------------------------- \n\n\n");    printf("Total no. of scans             taken: %d \n", scanned);    printf("Total no. of movements (steps) taken: %d \n\n",movement);    printf("[Energy Report] \n\n");    printf("Initial Energy           : % 1ld \n", vehicle.initialEnergy);    printf("Total Energy Used        : % 1ld \n", vehicle.totEnergyUsed);    printf("Total Shield Energy Used : % 1ld \n", vehicle.totShieldEnergyUsed);    printf("Energy Left              : % 1ld \n", vehicle.currEnergy);    printf("Shield Energy Left       : % 1ld \n\n", vehicle.currShieldEnergy);    printf("[Terrain type Scanned] \n\n");    printCountsAndEnergy(S_1_terrain, sizeof(S_1_terrain) / sizeof(S_1_terrain[0]), "[1 terrain units]");    printf("\n");    printCountsAndEnergy(S_2_terrain, sizeof(S_2_terrain) / sizeof(S_2_terrain[0]), "[2 terrain units]");    printf("\n");    printT_counter(T_terrain, sizeof(T_terrain) / sizeof(T_terrain[0]), "[Terrain type Explored]");	SCRelay_Signal_Veh_Close ();    return 0;}